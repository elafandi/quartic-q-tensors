# Quartic Q-Tensors
Numerical implementation of the experiments described in "Finite element analysis of a nematic liquid crystal Landau-de Gennes model with quartic elastic terms" by Jacob Elafandi (myself) and Franziska Weber.

Brief descriptions of contents:

- Julia scripts in the main directory:
	- `get_energy.jl`: Takes the filename of a stored Q-tensor field over a mesh generated by `triangulate_square.jl`, and outputs `F[Q]` and `||Q||`. If given two filenames, instead outputs `||Q_1 - Q_2||`.
	- `make_tactoid_diagrams.jl`: To be run after `trial_tactoid.jl`, this script generates the diagrams used in Figures 1, 2, and 3 in the paper.
	- `model2d.jl`: The central script. Given a triangulation and appropriate parameters, this script simulates the gradient flow and outputs the final Q-tensor field, as well as the energy history if desired. Saves intermediate results for each trial to prevent data loss from interruptions. For tactoid trials, creates eigenvalue plots and eigenvector plots every 0.5 time units until `t = 80`, and every 10 time units thereafter.
	- `parse_distmesh.jl`: Parses a triangulation generated by the MATLAB package [DistMesh](http://persson.berkeley.edu/distmesh/) and outputs a triangulation usable by `model2d.jl`. Used in the tactoid experiments.
	- `refine_Q.jl`: Given a Q-tensor field over a coarse mesh generated by `triangulate_square.jl`, interpolates it over a finer mesh generated by the same. Used in analyzing the spatial refinement results.
	- `trial_cfl.jl`: Runs the experiment from Section 5.2. Examines a simulation over a triangulated square, and by using binary search, finds lower and upper bounds of the maximum timestep for which this simulation converges. Does this for increasingly fine triangulations of the square.
	- `trial_spacerefine.jl`: Runs the experiment from Section 5.1.1. Examines a simulation over a triangulated square for increasingly fine triangulations. Computing the reference solution is by far the most time-consuming task in this repository; it takes eight days on my machine.
	- `trial_tactoid.jl`: Runs the experiments from Section 5.3. Examines a simulation over a triangulated circle and generates graphs. For tactoids of degree 1 and -1, runs the simulation until `t = 1000`; for tactoid of degree 0, runs until `t = 40`, at which point the tensor field has reached equilibrium.
	- `trial_timerefine.jl`: Runs the experiment from Section 5.1.2. Examines a simulation over a triangulated square for increasingly small time steps. Because the reference solution for this experiment is done over the same coarse grid, it doesn't take nearly as long.
	- `triangulate_square.jl`: Given the dimensions of a rectangle and the number of nodes per side, generates a triangulation to be used by `model2d.jl`.
- Other files in the main directory:
	- `cfl_results.txt`: Raw output from `trial_cfl.jl`, inserted into `tables.xlsx` manually for analysis.
	- `circle_362_p.txt`, `circle_362_t.txt`, `circle_1452_p.txt`, `circle_1452_t.txt`, `circle_5809_p.txt`, `circle_5809_t.txt`: Triangulations of the unit circle generated by the MATLAB package [DistMesh](http://persson.berkeley.edu/distmesh/), with 362, 1452, and 5809 points respectively. Each `*_p.txt` file stores a list of points in the plane, and the corresponding `*_t.txt` file stores a list of 3-tuples of point indices forming triangles. To by read by `parse_distmesh.jl`. The `circle_5809` triangulation is used in the tactoid experiment, and the `circle_362` triangulation is used to overlay the quiver plots of the vector field in Figures 1, 2, and 3.
	- `decomposition.pdf`: Outlines the decomposed numerical method which is implemented in `model2d.jl`. Began life as a section of the paper before we decided to spin it out.
	- `README.md`: This file.
	- `tables.xlsx`: Generates the tables used in the paper. Includes both the upper and lower bounds for the CFL results to demonstrate that they're the same up to rounding.
- `space_refinement_results`: Contains the output from `trial_spacerefine.jl`, sorted by subtrial. Each subfolder contains the intermediate and final values of Q for the specified number of triangles per side. All subfolders except the reference solution also include an interpolated final Q over a finer mesh, generated by `refine_Q.jl`.
- `time_refinement_results`: Contains the output from `trial_timerefine.jl`, sorted by subtrial. Each subfolder contains the intermediate and final values of Q for the specified number of triangles per side.
- `tactoid_results`:
	- `colorbar.png`: Image included at the bottoms of Figures 1, 2, and 3 for reference.
	- `tactoid_energy.png`: Figure 4 in the paper, generated from the energies text files in the subfolders.
	- `degree_one`, `degree_minus_one`, and `degree_zero`:
		- `tactoid_5809_*_both_*.png`: The plots included in the paper, consisting of an eigenvalue heat map beneath an eigenvector quiver plot, the latter of which is formed from interpolation on a coarser grid. Generated by `make_tactoid_diagrams.jl`.
		- `tactoid_5809_*_energies.txt`: Energies from running the simulation until `t = 100`, to be turned into `tactoid_energy.png`.
		- `tactoid_5809_*_Q_*.txt`: Intermediate tensor field results at given times, different for each tactoid. Used to create the paper graphs, or to prevent data loss.
		- `tactoid_5809_*_val_*.txt`: Eigenvalue heat maps at given times: every 0.5 time units until `t = 80`, and every 10 time units thereafter. Used to generate animations.
		- `tactoid_5809_*_vec_*.txt`: Eigenvector quiver plots at given times: every 0.5 time units until `t = 80`, and every 10 time units thereafter. Used to generate animations. Unlike the plots included in the paper, these plots are formed on the original, fine grid.
	- `animations`: GIF files created from the eigenvalue heat maps and eigenvector quiver plots in the other subfolders, showing how each tactoid decays in different ways and at different speeds.